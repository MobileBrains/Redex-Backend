<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="text-center">
                <h1 class="title">Consultar Estado de cargue</h1>
                <hr style="width: 100%; border-top: 1px solid #ad3f3f;">

            </div>
            <div class="col-md-12">
              <div class="row">
                <ul class="list-inline">
                  <li >
                    <div style="margin: 10px 10px;">
                      <label class="text_white">Mensajero:</label>
                      <%puts "#{@courrier_users[0]}" %>
                      <%= collection_select(:user, :name, @courrier_users, :name, :name, {prompt: true},
                      {:onchange => "getInfoByCourrierName()"} )%>
                    </div>
                  </li>

                  <li>
                    <div class="form-group form-inline">
                      <div class='input-group date' id='datetimepicker1'>
                          <input id="date1" type='text' class="form-control" />
                          <span class="input-group-addon">
                              <span class="glyphicon glyphicon-calendar"></span>
                          </span>
                      </div>
                      <div class='input-group date' id='datetimepicker2'>
                        <input id="date2" type='text' class="form-control" />
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-calendar"></span>
                        </span>
                      </div>
                      <button id="search_charge" onclick="infoBetweenDates()"> Buscar </button>
                    </div>

                  </li>

                  <li>
                    <div style="margin: 10px 10px;">
                    <label for="charge_number" class="text_white">Cargue</label>
                      <input type="text" name="charge_number" id="charge_number" placeholder="Numero de cargue">
                      <button id="search_charge" onclick="getInfoByChargeNumber()">Buscar </button>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">

                <div class="info">
                  <dl>
                    <dt>
                      <div class="col-md-12 text-center">
                            <div class="row">
                              <div class="col-md-12">
                                <div class="form-inline ">
                                  <label class="pull-left text_white">Pendientes:</label><label id="l_pendents" style="color: red" class="pull-right"></label>
                                </div>
                              </div>
                              <div class="col-md-12">
                                <div class="progress statusBar">
                                  <div id="bar_pendents" class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar"
                                  aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" >
                                  </div>
                                </div>
                              </div>
                            </div>
                        </div>
                      </dt>
                      <dt>
                        <div class="col-md-12 text-center">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-inline ">
                                <label class="pull-left text_white">Entregadas:</label><label id="l_delivered" style="color: red" class="pull-right"></label>
                              </div>
                            </div>
                            <div class="col-md-12">
                              <div class="progress statusBar">
                                <div id="bar_delivered" class="progress-bar progress-bar-success progress-bar-striped active " role="progressbar"
                                aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" >
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </dt>
                      <dt>
                        <div class="col-md-12 text-center">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-inline ">
                                <label class="pull-left text_white">Devoluciones:</label><label id="l_devolutions" style="color: red" class="pull-right"></label>
                              </div>
                            </div>
                            <div class="col-md-12">
                              <div class="progress statusBar">
                                <div id="bar_devolutions" class="progress-bar progress-bar-warning progress-bar-striped active " role="progressbar"
                                aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" >
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </dt>
                      <dt>
                        <div class="col-md-12 text-center">
                          <div class="form-inline ">
                            <label class="pull-left text_white">TOTAL: </label><label id="total" style="color: red" class="pull-right"></label>
                          </div>
                        </div>
                      </dt>
                  </dl>
                </div>
              </div>
            </div>
              <div class="bs-example bs-example-tabs" data-example-id="togglable-tabs">
                <ul class="nav nav-tabs" id="myTabs" role="tablist">
                  <li role="presentation" class="active">
                    <a href="#pending" id="pending-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">Pendientes</a>
                  </li>
                  <li class="" role="presentation">
                    <a aria-expanded="false" href="#delivered" role="tab" id="delivered-tab" data-toggle="tab" aria-controls="profile">Entregados</a>
                  </li>
                  <li class="" role="presentation">
                    <a aria-expanded="false" href="#devolution" role="tab" id="devolution-tab" data-toggle="tab" aria-controls="profile">Devoluciones</a>
                  </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                  <div class="tab-pane fade active in" role="tabpanel" id="pending" aria-labelledby="home-tab">
                    <% if @pending_orders.count != 0 %>

                      <div class="dataTables_wrapper" id="example_wrapper">
                        <div class="row">
                          <div class="container-fluid">
                            <div class="table-responsive">
                            <table class="table table-striped table-inverse dataTableBackground" id="pendent_orders" >
                              <thead>
                              <tr >
                                <th class="text-center">Numero cargue</th>
                                <th class="text-center">Fecha Radicado</th>
                                <th class="text-center">Courrier</th>
                                <th class="text-center">Guia Interna</th>
                                <th class="text-center">Destinatario</th>
                                <th class="text-center">Ciudad</th>
                                <th class="text-center">Direccion</th>
                                <th class="text-center">Detalles</th>
                              </tr>
                              </thead>
                              <tbody>
                              </tbody>
                            </table>
                            </div>
                          </div>
                        </div>
                      </div>
                      <%end%>
                  </div>
                  <div class="tab-pane fade" role="tabpanel" id="delivered" aria-labelledby="entregadas-tab">
                    <% if @delivered_orders.count != 0 %>
                      <div class="row">
                        <div class="container-fluid">
                          <div class="table-responsive">
                          <table class="table table-striped table-inverse dataTableBackground" id="delivered_orders" >
                            <thead>
                            <tr >
                              <th class="text-center">Numero cargue</th>
                              <th class="text-center">Fecha Radicado</th>
                              <th class="text-center">Fecha Entrega</th>
                              <th class="text-center">Courrier</th>
                              <th class="text-center">Guia Interna</th>
                              <th class="text-center">Destinatario</th>
                              <th class="text-center">Ciudad</th>
                              <th class="text-center">Direccion</th>
                              <th class="text-center">Imagen</th>
                              <th class="text-center">Detalles</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                          </table>
                          </div>
                        </div>
                      </div>
                    <%end%>
                  </div>
                  <div class="tab-pane fade" role="tabpanel" id="devolution" aria-labelledby="devoluciones-tab">
                    <% if @devolutions.count != 0 %>
                      <div class="row">
                        <div class="container-fluid">
                          <div class="table-responsive">
                          <table class="table table-striped table-inverse dataTableBackground" id="devolutions" >
                            <thead>
                            <tr >
                              <th class="text-center">Numero cargue</th>
                              <th class="text-center">Fecha Radicado</th>
                              <th class="text-center">Fecha Devolucion</th>
                              <th class="text-center">Courrier</th>
                              <th class="text-center">Ciudad</th>
                              <th class="text-center">Guia Interna</th>
                              <th class="text-center">Destinatario</th>
                              <th class="text-center">Direccion</th>
                              <th class="text-center">Imagen</th>
                              <th class="text-center">Detalles</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                          </table>
                          </div>
                        </div>
                      </div>
                    <%end%>
                  </div>
                </div>
              </div>
        </div>
    </div>
    <div class="id_id_message"></div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        var pendentsDataTable = $('#pendent_orders').DataTable({
          "pageLength": 50,
          "language":{
            "sProcessing":     "Procesando...",
            "sLengthMenu":     "Mostrar _MENU_ registros",
            "sZeroRecords":    "No se encontraron resultados",
            "sEmptyTable":     "Ningún dato disponible en esta tabla",
            "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
            "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
            "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
            "sInfoPostFix":    "",
            "sSearch":         "Buscar:",
            "sUrl":            "",
            "sInfoThousands":  ",",
            "sLoadingRecords": "Cargando...",
            "oPaginate": {
                "sFirst":    "Primero",
                "sLast":     "Último",
                "sNext":     "Siguiente",
                "sPrevious": "Anterior"
            },
            "oAria": {
                "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                "sSortDescending": ": Activar para ordenar la columna de manera descendente"
            }
          }
        });

        var deliveredDataTable = $('#delivered_orders').DataTable({
          "pageLength": 50,
          "language":{
            "sProcessing":     "Procesando...",
            "sLengthMenu":     "Mostrar _MENU_ registros",
            "sZeroRecords":    "No se encontraron resultados",
            "sEmptyTable":     "Ningún dato disponible en esta tabla",
            "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
            "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
            "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
            "sInfoPostFix":    "",
            "sSearch":         "Buscar:",
            "sUrl":            "",
            "sInfoThousands":  ",",
            "sLoadingRecords": "Cargando...",
            "oPaginate": {
                "sFirst":    "Primero",
                "sLast":     "Último",
                "sNext":     "Siguiente",
                "sPrevious": "Anterior"
            },
            "oAria": {
                "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                "sSortDescending": ": Activar para ordenar la columna de manera descendente"
            }
          }
        });
        var devolutionsDataTable = $('#devolutions').DataTable({
          "pageLength": 50,
          "language":{
            "sProcessing":     "Procesando...",
            "sLengthMenu":     "Mostrar _MENU_ registros",
            "sZeroRecords":    "No se encontraron resultados",
            "sEmptyTable":     "Ningún dato disponible en esta tabla",
            "sInfo":           "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
            "sInfoEmpty":      "Mostrando registros del 0 al 0 de un total de 0 registros",
            "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
            "sInfoPostFix":    "",
            "sSearch":         "Buscar:",
            "sUrl":            "",
            "sInfoThousands":  ",",
            "sLoadingRecords": "Cargando...",
            "oPaginate": {
                "sFirst":    "Primero",
                "sLast":     "Último",
                "sNext":     "Siguiente",
                "sPrevious": "Anterior"
            },
            "oAria": {
                "sSortAscending":  ": Activar para ordenar la columna de manera ascendente",
                "sSortDescending": ": Activar para ordenar la columna de manera descendente"
            }
          }
        });

        document.addEventListener("turbolinks:before-cache", function() {
          pendentsDataTable.destroy();
        });
        document.addEventListener("turbolinks:before-cache", function() {
          deliveredDataTable.destroy();
        });
        document.addEventListener("turbolinks:before-cache", function() {
          devolutionsDataTable.destroy();
        });

        $('.notImage').click(false);


        $('#datetimepicker1').datetimepicker({
          format: 'YYYY-MM-DD ',
          locale: 'es'
        });
        $('#datetimepicker2').datetimepicker({
          format: 'YYYY-MM-DD ',
          locale: 'es'
          });


    });

    function getInfoByChargeNumber(){
      $.ajax({
          url: '/home/ordersByChargeNumber/',
          type: 'POST',
          data: {
            charge_number: $('#charge_number').val()
          },
          success: function(data) {
            responsaData = data;

            var total = data.length;

            var pendent_count=0;

            var delivered_count=0;

            var devolutions_count=0;

            var t_pendent_orders = $("#pendent_orders").DataTable();
            var t_delivered_orders = $("#delivered_orders").DataTable();
            var t_devolutions = $("#devolutions").DataTable();

            //cleaning table
            t_pendent_orders.clear()
              .draw();
            t_delivered_orders.clear()
              .draw();
            t_devolutions.clear()
              .draw();

            //populating table
            $.each(responsaData,function(index,value){

              if (value.state == "pendiente") {
                pendent_count++;
                $("#l_pendents").html(pendent_count);
                t_pendent_orders.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivery_man,
                value.internal_guide,
                value.destinatary,
                value.city,
                value.address,
                '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"></dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );
              }
              else if (value.state == "entregada") {
                delivered_count++;
                $("#l_delivered").html(delivered_count);
                t_delivered_orders.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivered_at,
                value.delivery_man,
                value.internal_guide,
                value.destinatary,
                value.city,
                value.address,
                value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>' ,
                '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );
              }
              else if (value.state == "devolucion") {
                devolutions_count++;
                $("#l_devolutions").html(devolutions_count);
                t_devolutions.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivered_at,
                value.delivery_man,
                value.city,
                value.internal_guide,
                value.destinatary,
                value.address,
                value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>',
                '<button type="button" onclick="getDevolutionReasonAndObservation('+value.id+')" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Razon de devolucion:</label></div><div class="col-md-9 text-center" id="devolutionReason_'+value.id+'"></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Observacion: </label></div><div class="col-md-9 text-center" id="observation_'+value.id+'"></div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );

              }
              //alert("s"+responsaData[index].state+value.delivery_man);
            });
            progress(pendent_count,delivered_count,devolutions_count,total);
            return(responsaData);
          },
          error: function(data) {
            console.log(data);
          }
        });
    }

    function getInfoByCourrierName(){
      $.ajax({
        url: '/home/ordersByCourrierName/',
        type: 'POST',
        data: {
          name: $('#user_name').val()
        },
        success: function(data) {
          responseData = data;

          var total = data.length;

          var pendent_count=0;

          var delivered_count=0;

          var devolutions_count=0;

          var t_pendent_orders = $("#pendent_orders").DataTable();
          var t_delivered_orders = $("#delivered_orders").DataTable();
          var t_devolutions = $("#devolutions").DataTable();

          //cleaning table
          t_pendent_orders.clear()
            .draw();
          t_delivered_orders.clear()
            .draw();
          t_devolutions.clear()
            .draw();

          //populating table
          $.each(responseData,function(index,value){

            if (value.state == "pendiente") {
              pendent_count++;
              $("#l_pendents").html(pendent_count);
              t_pendent_orders.row.add( [
              value.charge_number,
              value.radication_at,
              value.delivery_man,
              value.internal_guide,
              value.destinatary,
              value.city,
              value.address,
              '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"></dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
              ] ).draw( false );
            }
            else if (value.state == "entregada") {
              delivered_count++;
              $("#l_delivered").html(delivered_count);
              t_delivered_orders.row.add( [
              value.charge_number,
              value.radication_at,
              value.delivered_at,
              value.delivery_man,
              value.internal_guide,
              value.destinatary,
              value.city,
              value.address,
              value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>' ,
              '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
              ] ).draw( false );
            }
            else if (value.state == "devolucion") {
              devolutions_count++;
              $("#l_devolutions").html(devolutions_count);
              t_devolutions.row.add( [
              value.charge_number,
              value.radication_at,
              value.delivered_at,
              value.delivery_man,
              value.city,
              value.internal_guide,
              value.destinatary,
              value.address,
              value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>',
              '<button type="button" onclick="getDevolutionReasonAndObservation('+value.id+')" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Razon de devolucion:</label></div><div class="col-md-9 text-center" id="devolutionReason_'+value.id+'"></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Observacion: </label></div><div class="col-md-9 text-center" id="observation_'+value.id+'"></div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
              ] ).draw( false );

            }
            //alert("s"+responseData[index].state+value.delivery_man);
          });
          progress(pendent_count,delivered_count,devolutions_count,total);
          return(responseData);
        },
        error: function(data) {
          console.log(data);
        }
      });
    }

    function infoBetweenDates(){
      $.ajax({
          url: '/home/infoBetweenDates/',
          type: 'POST',
          data: {
            name: $('#user_name').val(),
            date1: $('#date1').val(),
            date2: $('#date2').val()
          },
          success: function(data) {
            responsaData = data;

            var total = data.length;

            var pendent_count=0;

            var delivered_count=0;

            var devolutions_count=0;

            var t_pendent_orders = $("#pendent_orders").DataTable();
            var t_delivered_orders = $("#delivered_orders").DataTable();
            var t_devolutions = $("#devolutions").DataTable();

            //cleaning table
            t_pendent_orders.clear()
              .draw();
            t_delivered_orders.clear()
              .draw();
            t_devolutions.clear()
              .draw();

            //populating table
            $.each(responsaData,function(index,value){

              if (value.state == "pendiente") {
                pendent_count++;
                $("#l_pendents").html(pendent_count);
                t_pendent_orders.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivery_man,
                value.internal_guide,
                value.destinatary,
                value.city,
                value.address,
                '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"></dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );
              }
              else if (value.state == "entregada") {
                delivered_count++;
                $("#l_delivered").html(delivered_count);
                t_delivered_orders.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivered_at,
                value.delivery_man,
                value.internal_guide,
                value.destinatary,
                value.city,
                value.address,
                value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>' ,
                '<button type="button" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );
              }
              else if (value.state == "devolucion") {
                devolutions_count++;
                $("#l_devolutions").html(devolutions_count);
                t_devolutions.row.add( [
                value.charge_number,
                value.radication_at,
                value.delivered_at,
                value.delivery_man,
                value.city,
                value.internal_guide,
                value.destinatary,
                value.address,
                value.image === null || value.image === undefined || value.image === "" ? '':'<div class="text-center"><a href="'+ value.image +'" target="_blank"><i class="fa fa-camera fa-2x alert-success"></i></a></div>',
                '<button type="button" onclick="getDevolutionReasonAndObservation('+value.id+')" class="btn btn-primary btn-md" data-toggle="modal" data-target="#'+value.internal_guide +'">Ver más</button><!-- Modal --><div class="modal fade" id="'+value.internal_guide +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Detalles Guia</h4></div><div class="modal-body"><dl><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Interna: </label></div><div class="col-md-9 text-center"><label style="color:red">'+ value.internal_guide +'</label></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Radicado: </label></div><div class="col-md-9 text-center">'+ value.radication_at +'</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Fecha Entrega: </label></div><div class="col-md-9 text-center">' + value.delivered_at + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Numero Cargue: </label></div><div class="col-md-9 text-center">' + value.charge_number + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Mensajero: </label></div><div class="col-md-9 text-center">' + value.delivery_man + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Ciudad: </label></div><div class="col-md-9 text-center">' + value.city + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Destinatario: </label></div><div class="col-md-9 text-center">' + value.destinatary + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Direccion: </label></div><div class="col-md-9 text-center">' + value.address + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Cliente: </label></div><div class="col-md-9 text-center">'+ value.client + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Guia Externa: </label></div><div class="col-md-9 text-center">' + value.externa_guide + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Estado: </label></div><div class="col-md-9 text-center">' + value.state + '</div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Razon de devolucion:</label></div><div class="col-md-9 text-center" id="devolutionReason_'+value.id+'"></div></div></dt><hr class="hr_modal"><dt><div class="row"><div class="col-md-3"><label class="pull-left">Observacion: </label></div><div class="col-md-9 text-center" id="observation_'+value.id+'"></div></div></dt><hr class="hr_modal">'+( value.image === null || value.image === undefined || value.image === "" ? '' : '<dt><div class="row"><div class="col-md-3"><label class="pull-left">Imagen: </label></div><div class="col-md-9 text-center"><img style="width: 80%" src=' +value.image +'></div></div></dt>') +'</dl></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 100%">Cerrar</button></div></div></div></div>'
                ] ).draw( false );

              }
              //alert("s"+responsaData[index].state+value.delivery_man);
            });
            progress(pendent_count,delivered_count,devolutions_count,total);
            return(responsaData);
          },
          error: function(data) {
            console.log(data);
          }
        });
    }

    function getDevolutionReasonAndObservation(delivery_order_id){
      console.error(delivery_order_id)
      $.ajax({
        url: '/home/devolutionReasonAndObservation/',
        type: 'POST',
        data: {
          delivery_order_id: delivery_order_id
        },
        success: function(data) {
          x = data;
          $.each(x,function(index,value){
            $("#devolutionReason_"+delivery_order_id).html(value[0]);
            $("#observation_"+delivery_order_id).html(value[1]);
          })
        },
        error: function(data) {
          console.log(data);
        }
      });
    }

    function  progress(pendent_count,delivered_count,devolutions_count,total){
      $("#bar_pendents").width(0);
      $("#bar_delivered").width(0);
      $("#bar_devolutions").width(0);
      $("#total").html(total);
      $("#l_pendents").html(pendent_count);
      $("#l_delivered").html(delivered_count);
      $("#l_devolutions").html(devolutions_count);

      var pendents = (pendent_count*100) / total;
      $("#bar_pendents").width(pendents+'%');

      var delivered = (delivered_count*100) / total;
      $("#bar_delivered").width(delivered+'%');

      var devolutions = (devolutions_count*100) / total;
      $("#bar_devolutions").width(devolutions+'%');
    }
</script>